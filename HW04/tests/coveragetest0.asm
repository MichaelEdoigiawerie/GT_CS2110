.orig x0000

;; Test AND imm5
AND R0, R0, 0 ; Clear R0

;; Test ADD imm5
AND R1, R1, 0
ADD R1, R1, 5
BRnz INCORRECT_CC1
JSR CORRECT_CC
INCORRECT_CC1

;; Test NOT
NOT R1, R1
BRzp INCORRECT_CC2
JSR CORRECT_CC
INCORRECT_CC2
ADD R1, R1, 1

;; Test ADD
ADD R1, R0, R1
BRzp INCORRECT_CC3
JSR CORRECT_CC
INCORRECT_CC3

;; Test ADD cc
ADD R2, R1, -10
BRzp INCORRECT_CC4
JSR CORRECT_CC
INCORRECT_CC4

;; Test LEA
LEA R7, MY_LABEL2
BRzp INCORRECT_CC5
JSR CORRECT_CC
INCORRECT_CC5

;; Test store
LEA R5, MY_LABEL2
ADD R5, R5, -1
ST R5, MY_LABEL2

AND R7, R7, 0
BRnp INCORRECT_CC6
JSR CORRECT_CC
INCORRECT_CC6

;; Test LDI
LDI R4, MY_LABEL2
BRnz INCORRECT_CC7
JSR CORRECT_CC
INCORRECT_CC7

;; Test JSRR
LEA R5, MY_SR
JSRR R5
BRnz INCORRECT_CC8
JSR CORRECT_CC
INCORRECT_CC8

;; Test STI
AND R6, R6, 0
ADD R6, R6, -5
STI R6, MY_LABEL2

ADD R1, R1, R4

;; Test LDR
LEA R5, MY_LABEL
LDR R6, R5, 2
BRzp INCORRECT_CC9
JSR CORRECT_CC
INCORRECT_CC9

;; Test JMP
LEA R7, JMP_LABEL
JMP R7
ADD R0, R0, 1 ; Messed up
JMP_LABEL

;; Load results into registers so we can easily grade them
LD R5, MY_LABEL
LD R6, MY_LABEL2
LD R3, CORRECT_CC_COUNT ; Load correct cc count in R7

HALT

;; Subroutine
MY_SR
ADD R4, R4, 8
RET

;; Subroutine to increment correct CC count
CORRECT_CC
LD R6, CORRECT_CC_COUNT
ADD R6, R6, 1 ; Increase count
ST R6, CORRECT_CC_COUNT
RET

CORRECT_CC_COUNT .fill 0

MY_LABEL .fill 4
MY_LABEL2 .fill 5
MY_LABEL3 .fill -8

.end
